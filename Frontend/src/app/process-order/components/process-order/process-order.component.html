<form [formGroup]="form" (ngSubmit)="submit()" class="pb-5">
  <div class="container my-4">
    <div class="row g-4">

      <!-- LEFT COLUMN: Shipping & Payment -->
      <div class="col-xl-7">

        <!-- Shipping Info -->
        <div class="card mb-4">
          <div class="card-header d-flex align-items-center">
            <i class="bx bxs-receipt text-primary me-2 fs-4"></i>
            <h5 class="mb-0">Shipping Info</h5>
          </div>
          <div class="card-body">

            <!-- Name -->
            <div class="row mb-3">
              <div class="col-md-4">
                <label class="form-label">First Name</label>
                <input type="text" class="form-control" formControlName="firstName" placeholder="Enter First Name">
              </div>
              <div class="col-md-4">
                <label class="form-label">Last Name</label>
                <input type="text" class="form-control" formControlName="lastName" placeholder="Enter Last Name">
              </div>
            </div>

            <!-- Contact -->
            <div class="row mb-3">
              <div class="col-md-4">
                <label class="form-label">Email Address</label>
                <input type="email" class="form-control" formControlName="email" placeholder="Enter email">
              </div>
              <div class="col-md-4">
                <label class="form-label">Phone</label>
                <input type="text" class="form-control" formControlName="phone" placeholder="Enter phone no.">
              </div>
            </div>

            <!-- Address -->
            <div class="mb-3">
              <label class="form-label">Address</label>
              <input type="text" class="form-control" formControlName="address" placeholder="Enter full address">
            </div>

            <!-- Location -->
            <div class="row mb-3">
              <div class="col-md-4">
                <label class="form-label">Country</label>
                <select class="form-select"
                        formControlName="country"
                        (change)="onCountryChange()">
                  <option value="">Select Country</option>
                  <option *ngFor="let country of countries" [ngValue]="country">
                    {{ country.name }}
                  </option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label">City</label>
                <select class="form-select" formControlName="city">
                  <option value="">Select City</option>
                  <option *ngFor="let city of cities" [ngValue]="city">
                    {{ city.name }}
                  </option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label">Zip / Postal Code</label>
                <input type="text" class="form-control" formControlName="zip" placeholder="Enter postal code">
              </div>
            </div>

            <!-- Additional -->
            <div class="mb-3">
              <label class="form-label">Additional Information</label>
              <textarea class="form-control" formControlName="additional" rows="3" placeholder="Additional information"></textarea>
            </div>
          </div>
        </div>

        <!-- Payment Info -->
        <div class="card">
          <div class="card-header d-flex align-items-center">
            <i class="bx bxs-wallet-alt text-primary me-2 fs-4"></i>
            <h5 class="mb-0">Payment Info</h5>
          </div>
          <div class="card-body">
            <h6 class="mb-3">Payment Method:</h6>
            <div class="form-check">
              <input class="form-check-input" type="radio" value="cash_on_delivery" id="pay-cod" formControlName="paymentMethod" >
              <label class="form-check-label" for="pay-cod">
                <i class="bx bx-money me-1"></i> Cash on Delivery
              </label>
            </div>
          </div>
        </div>

      </div>

      <!-- RIGHT COLUMN: Order Summary -->
      <div class="col-xl-5">
        <div class="card checkout-order-summary">
          <div class="card-header">
            <h5 class="mb-0">Order Summary</h5>
          </div>
          <div class="card-body">

            <!-- Products -->
            <div *ngFor="let item of cartProducts" class="d-flex align-items-center mb-3">
              <img [src]="item.product.image" alt="product" class="img-thumbnail me-3" style="width:60px; height:60px; object-fit:cover;">
              <div>
                <div>{{ item.product.name }}</div>
                <small class="text-muted">${{ item.product.price }} Ã— {{ item.quantity }}</small>
              </div>
              <div class="ms-auto fw-bold">${{ item.total }}</div>
            </div>

            <hr>

            <!-- Totals -->
            <div class="d-flex justify-content-between mb-2">
              <span>Sub Total:</span>
              <strong>${{ subTotal }}</strong>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Shipping Charge:</span>
              <strong>$0</strong>
            </div>
            <hr>
            <div class="d-flex justify-content-between">
              <span>Total:</span>
              <strong>${{ subTotal }}</strong>
            </div>

            <!-- Submit -->
            <button type="submit" class="btn btn-success w-100 mt-3">
              <i class="mdi mdi-cart-outline me-1"></i> Send Order
            </button>

          </div>
        </div>
      </div>

    </div>
  </div>
</form>
